<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.4.553">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Gabriel Odom">
<meta name="dcterms.date" content="2019-10-02">

<title>PHC 6701: R for Data Science - Lesson 9 Supplement: Compare dplyr and base R Subsetting</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../site_libs/clipboard/clipboard.min.js"></script>
<script src="../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../site_libs/quarto-search/fuse.min.js"></script>
<script src="../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../">
<link href="../lessons/lesson10_stringr.html" rel="next">
<link href="../lessons/lesson09_dplyr.html" rel="prev">
<script src="../site_libs/quarto-html/quarto.js"></script>
<script src="../site_libs/quarto-html/popper.min.js"></script>
<script src="../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../site_libs/quarto-html/anchor.min.js"></script>
<link href="../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>


<link rel="stylesheet" href="../styles.css">
</head>

<body class="nav-sidebar docked">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="../lessons/lesson09s_dplyr_v_base.html">Lesson 9 Supplement: Compare dplyr and base R Subsetting</a></li></ol></nav>
        <a class="flex-grow-1" role="button" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
      <button type="button" class="btn quarto-search-button" aria-label="" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation docked overflow-auto">
    <div class="pt-lg-2 mt-2 text-left sidebar-header">
    <div class="sidebar-title mb-0 py-0">
      <a href="../">PHC 6701: R for Data Science</a> 
    </div>
      </div>
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Home</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../lessons/lesson01_greater_data_science.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Lesson 1: Overview of Data Science</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../lessons/lesson02_introduction_to_R.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Lesson 2: Introduction to R</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../lessons/lesson02s_scripts.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Lesson 2 Supplement: R Scripts</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../lessons/lesson03_introduction_to_Quarto.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Lesson 3: Quarto for Reproducible Reports</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../lessons/lesson04_ggplot.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Lesson 4: ggplot and the Layered Grammar of Graphics</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../lessons/lesson04s_examples.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Lesson 4 Supplement: ggplot Examples</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../lessons/lesson05_RStudio_projects.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Lesson 5: RStudio Projects</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../lessons/lesson06_atomic_vectors.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Lesson 6: Atomic Vectors</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../lessons/lesson07_lists_and_tibbles.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Lesson 7: Lists and Tibbles</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../lessons/lesson08_Data_Read_Write.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Lesson 8: Importing Tidy Data</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../lessons/lesson09_dplyr.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Lesson 9: Data Manipulation with dplyr</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../lessons/lesson09s_dplyr_v_base.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text">Lesson 9 Supplement: Compare dplyr and base R Subsetting</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../lessons/lesson10_stringr.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Lesson 10: Wrangling Character Strings with stringr</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../lessons/lesson11_functions.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Lesson 11: Functions and Control Flow in R</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../lessons/lesson12_purrr.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Lesson 12: Functional Iteration with purrr</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../lessons/lesson13_eda_w_tidyverse.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Lesson 13: Exploring Data with the Tidyverse</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../lessons/lesson14_github.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Lesson 14: Links for Getting Started with GitHub</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../lessons/lesson00_preassessment.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">R for Data Science Pre-Assessment</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../about.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">About</span></a>
  </div>
</li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul class="collapse">
  <li><a href="#overview" id="toc-overview" class="nav-link active" data-scroll-target="#overview">Overview</a></li>
  <li><a href="#data-sets" id="toc-data-sets" class="nav-link" data-scroll-target="#data-sets">Data Sets</a>
  <ul class="collapse">
  <li><a href="#the-heroes_tbldf-data" id="toc-the-heroes_tbldf-data" class="nav-link" data-scroll-target="#the-heroes_tbldf-data">The <code>heroes_tbldf</code> Data</a></li>
  <li><a href="#framingham-data" id="toc-framingham-data" class="nav-link" data-scroll-target="#framingham-data">Framingham Data</a></li>
  <li><a href="#gapminder-data" id="toc-gapminder-data" class="nav-link" data-scroll-target="#gapminder-data">Gapminder Data</a></li>
  </ul></li>
  <li><a href="#row-subsetting" id="toc-row-subsetting" class="nav-link" data-scroll-target="#row-subsetting">Row Subsetting</a>
  <ul class="collapse">
  <li><a href="#base" id="toc-base" class="nav-link" data-scroll-target="#base">base</a></li>
  <li><a href="#dplyr" id="toc-dplyr" class="nav-link" data-scroll-target="#dplyr">dplyr</a></li>
  </ul></li>
  <li><a href="#column-subsetting" id="toc-column-subsetting" class="nav-link" data-scroll-target="#column-subsetting">Column Subsetting</a>
  <ul class="collapse">
  <li><a href="#base-r" id="toc-base-r" class="nav-link" data-scroll-target="#base-r">base R</a></li>
  <li><a href="#dplyr-1" id="toc-dplyr-1" class="nav-link" data-scroll-target="#dplyr-1">dplyr</a></li>
  </ul></li>
  <li><a href="#relational-subsetting" id="toc-relational-subsetting" class="nav-link" data-scroll-target="#relational-subsetting">Relational Subsetting</a>
  <ul class="collapse">
  <li><a href="#example-1-framingham-young-women" id="toc-example-1-framingham-young-women" class="nav-link" data-scroll-target="#example-1-framingham-young-women">Example 1: Framingham Young Women</a></li>
  <li><a href="#example-2-countries-with-highest-infant-mortality" id="toc-example-2-countries-with-highest-infant-mortality" class="nav-link" data-scroll-target="#example-2-countries-with-highest-infant-mortality">Example 2: Countries with Highest Infant Mortality</a></li>
  </ul></li>
  <li><a href="#concluding-remarks" id="toc-concluding-remarks" class="nav-link" data-scroll-target="#concluding-remarks">Concluding Remarks</a></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">Lesson 9 Supplement: Compare dplyr and base R Subsetting</h1>
</div>



<div class="quarto-title-meta">

    <div>
    <div class="quarto-title-meta-heading">Author</div>
    <div class="quarto-title-meta-contents">
             <p>Gabriel Odom </p>
          </div>
  </div>
    
    <div>
    <div class="quarto-title-meta-heading">Published</div>
    <div class="quarto-title-meta-contents">
      <p class="date">October 2, 2019</p>
    </div>
  </div>
  
    <div>
    <div class="quarto-title-meta-heading">Modified</div>
    <div class="quarto-title-meta-contents">
      <p class="date-modified">November 29, 2023</p>
    </div>
  </div>
    
  </div>
  


</header>


<section id="overview" class="level1">
<h1>Overview</h1>
<p>We will discuss/review</p>
<ol type="1">
<li>The data sets</li>
<li>Row subsetting</li>
<li>Column subsetting</li>
<li>Relational subsetting</li>
</ol>
<p>This lesson will not compare merging two data sets using basic R, because the dplyr version is superior in almost every way.</p>
<p><br></p>
<hr>
<p><br></p>
</section>
<section id="data-sets" class="level1">
<h1>Data Sets</h1>
<p>In this class, we have used a few different data sets. The table below gives the names of the data sets and their sources.</p>
<table class="table">
<colgroup>
<col style="width: 38%">
<col style="width: 61%">
</colgroup>
<thead>
<tr class="header">
<th>Data Set</th>
<th>Source</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><code>heroes_tbldf</code></td>
<td>In class: code below</td>
</tr>
<tr class="even">
<td><code>framingham_tbldf</code></td>
<td><code>LocalControl</code> with modifications shown below</td>
</tr>
<tr class="odd">
<td><code>gapminder_tbldf</code></td>
<td><code>dslabs</code> with modifications shown below</td>
</tr>
</tbody>
</table>
<div class="callout callout-style-default callout-tip callout-titled" title="tip">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
tip
</div>
</div>
<section id="tip-whats-in-a-name" class="level2 callout-body-container callout-body">
<h2 class="anchored" data-anchor-id="tip-whats-in-a-name">Tip: What’s in a Name?</h2>
<p>Up to this point in the semester, I have used the object name ending <code>_df</code> exclusively to mean a “tibble” (or modern data frame). In this lesson, I will use <code>_tbldf</code> to mean “tibble” instead of <code>_df</code>, and I will mark data in the traditional “data frame” class with <code>_dataframe</code>. After this lesson is over, I will go back to using <code>_df</code> to mean “tibble”, and we will probably never speak of “old” data frames again.</p>
</section>
</div>
<section id="the-heroes_tbldf-data" class="level2">
<h2 class="anchored" data-anchor-id="the-heroes_tbldf-data">The <code>heroes_tbldf</code> Data</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a>heroes_tbldf <span class="ot">&lt;-</span> <span class="fu">tibble</span>(</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">subject_ID =</span> <span class="fu">factor</span>(<span class="fu">c</span>(<span class="st">"008"</span>, <span class="st">"016"</span>, <span class="st">"115"</span>, <span class="st">"027"</span>, <span class="st">"001"</span>)),</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">name =</span> <span class="fu">c</span>(<span class="st">"Wonder Woman"</span>, <span class="st">"Green Lantern"</span>, <span class="st">"Spider-Man"</span>, <span class="st">"Batman"</span>, <span class="st">"Superman"</span>),</span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">alias =</span> <span class="fu">c</span>(</span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Diana Prince"</span>, <span class="st">"Alan Scott"</span>, <span class="st">"Peter Parker"</span>, <span class="st">"Bruce Wayne"</span>,</span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Clark Kent / Kal-El"</span></span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a>  ),</span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a>  <span class="at">city =</span> <span class="fu">c</span>(</span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Gateway City"</span>, <span class="st">"Capitol City"</span>, <span class="st">"New York City"</span>, <span class="st">"Gotham"</span>, <span class="st">"Metropolis"</span></span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a>  ),</span>
<span id="cb1-11"><a href="#cb1-11" aria-hidden="true" tabindex="-1"></a>  <span class="at">male =</span> <span class="fu">c</span>(<span class="cn">FALSE</span>, <span class="cn">TRUE</span>, <span class="cn">TRUE</span>, <span class="cn">TRUE</span>, <span class="cn">TRUE</span>),</span>
<span id="cb1-12"><a href="#cb1-12" aria-hidden="true" tabindex="-1"></a>  <span class="at">heightCM =</span> <span class="fu">c</span>(<span class="fl">183.5</span>, <span class="fl">182.9</span>, <span class="fl">177.8</span>, <span class="fl">188.0</span>, <span class="fl">190.5</span>),</span>
<span id="cb1-13"><a href="#cb1-13" aria-hidden="true" tabindex="-1"></a>  <span class="at">weightKg =</span> <span class="fu">c</span>(<span class="fl">74.8</span>, <span class="fl">91.2</span>, <span class="fl">75.7</span>, <span class="fl">95.3</span>, <span class="fl">106.6</span>),</span>
<span id="cb1-14"><a href="#cb1-14" aria-hidden="true" tabindex="-1"></a>  <span class="at">firstRun =</span> <span class="fu">c</span>(<span class="dv">1941</span>L, <span class="dv">1940</span>L, <span class="dv">1962</span>L, <span class="dv">1939</span>L, <span class="dv">1938</span>L)</span>
<span id="cb1-15"><a href="#cb1-15" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="framingham-data" class="level2">
<h2 class="anchored" data-anchor-id="framingham-data">Framingham Data</h2>
<p>For the examples in this comparison document, we will use the first 20 records of the Framingham data only. Notice that the only difference between <code>framingham_df</code> and <code>framingham_tbldf</code> is that we forced the <code>_tbldf</code> version to be a tibble (modern data frame).</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="co"># install.packages("LocalControl")</span></span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(LocalControl)</span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Base R data frame</span></span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a>framingham_dataframe <span class="ot">&lt;-</span> </span>
<span id="cb2-6"><a href="#cb2-6" aria-hidden="true" tabindex="-1"></a>  framingham <span class="sc">%&gt;%</span> </span>
<span id="cb2-7"><a href="#cb2-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">sex =</span> <span class="fu">ifelse</span>(female <span class="sc">==</span> <span class="dv">1</span>, <span class="at">yes =</span> <span class="st">"Female"</span>, <span class="at">no =</span> <span class="st">"Male"</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb2-8"><a href="#cb2-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">curSmoke =</span> cursmoke <span class="sc">==</span> <span class="dv">1</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb2-9"><a href="#cb2-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">highBP =</span> outcome <span class="sc">==</span> <span class="dv">1</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb2-10"><a href="#cb2-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">death =</span> outcome <span class="sc">==</span> <span class="dv">2</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb2-11"><a href="#cb2-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="sc">-</span>female, <span class="sc">-</span>cursmoke, <span class="sc">-</span>outcome) <span class="sc">%&gt;%</span> </span>
<span id="cb2-12"><a href="#cb2-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">slice</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">20</span>)</span>
<span id="cb2-13"><a href="#cb2-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-14"><a href="#cb2-14" aria-hidden="true" tabindex="-1"></a><span class="co"># Tibble</span></span>
<span id="cb2-15"><a href="#cb2-15" aria-hidden="true" tabindex="-1"></a>framingham_tbldf <span class="ot">&lt;-</span> <span class="fu">as_tibble</span>(framingham_dataframe)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="gapminder-data" class="level2">
<h2 class="anchored" data-anchor-id="gapminder-data">Gapminder Data</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="co"># install.packages("dslabs")</span></span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(dslabs)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: package 'dslabs' was built under R version 4.5.2</code></pre>
</div>
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Base R data frame</span></span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a>gapminder_dataframe <span class="ot">&lt;-</span></span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a>  gapminder <span class="sc">%&gt;%</span> </span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">gdpPerCap =</span> gdp <span class="sc">/</span> population)</span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-6"><a href="#cb5-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Tibble</span></span>
<span id="cb5-7"><a href="#cb5-7" aria-hidden="true" tabindex="-1"></a>gapminder_tbldf <span class="ot">&lt;-</span> <span class="fu">as_tibble</span>(gapminder_dataframe)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p><br></p>
<hr>
<p><br></p>
</section>
</section>
<section id="row-subsetting" class="level1">
<h1>Row Subsetting</h1>
<section id="base" class="level2">
<h2 class="anchored" data-anchor-id="base">base</h2>
<p>To select the first row of a tibble using basic R subsetting rules, use the <code>[</code> function. This follows <code>row, column</code> syntax.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a>framingham_dataframe[<span class="dv">1</span>, ]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  totchol age   bmi BPVar heartrte glucose time_outcome cigpday  sex curSmoke
1     195  39 26.97   -17       80      77           24       0 Male    FALSE
  highBP death
1  FALSE FALSE</code></pre>
</div>
</div>
<p>This returns a 1-row data frame.</p>
</section>
<section id="dplyr" class="level2">
<h2 class="anchored" data-anchor-id="dplyr">dplyr</h2>
<p>To select the first row of a tibble using dplyr subsetting rules, use <code>[</code> or the <code>slice()</code> function. This uses row position only.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a>framingham_tbldf <span class="sc">%&gt;%</span> </span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">slice</span>(<span class="dv">1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 1 × 12
  totchol   age   bmi BPVar heartrte glucose time_outcome cigpday sex   curSmoke
    &lt;int&gt; &lt;int&gt; &lt;dbl&gt; &lt;dbl&gt;    &lt;int&gt;   &lt;int&gt;        &lt;dbl&gt;   &lt;int&gt; &lt;chr&gt; &lt;lgl&gt;   
1     195    39  27.0   -17       80      77           24       0 Male  FALSE   
# ℹ 2 more variables: highBP &lt;lgl&gt;, death &lt;lgl&gt;</code></pre>
</div>
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a>framingham_tbldf[<span class="dv">1</span>, ]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 1 × 12
  totchol   age   bmi BPVar heartrte glucose time_outcome cigpday sex   curSmoke
    &lt;int&gt; &lt;int&gt; &lt;dbl&gt; &lt;dbl&gt;    &lt;int&gt;   &lt;int&gt;        &lt;dbl&gt;   &lt;int&gt; &lt;chr&gt; &lt;lgl&gt;   
1     195    39  27.0   -17       80      77           24       0 Male  FALSE   
# ℹ 2 more variables: highBP &lt;lgl&gt;, death &lt;lgl&gt;</code></pre>
</div>
</div>
<p>These both return the same 1-row tibble.</p>
<p><br></p>
<hr>
<p><br></p>
</section>
</section>
<section id="column-subsetting" class="level1">
<h1>Column Subsetting</h1>
<section id="base-r" class="level2">
<h2 class="anchored" data-anchor-id="base-r">base R</h2>
<p>To select the first column of a tibble using basic R subsetting rules, again use the <code>[</code> function. This follows <code>row, column</code> syntax, so move the <code>1</code> on the other side of the comma.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a>framingham_dataframe[, <span class="dv">1</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> [1] 195 250 245 285 205 313 254 247 291 195 195 190 215 294 247 295 226 175 180
[20] 243</code></pre>
</div>
</div>
<p>This returns an atomic vector of length 20.</p>
<p>Because tibbles are also lists, we can use the list subsetting rules for columns as well. To subset by column position, we can use the <code>[</code> or the <code>[[</code> functions (for <em>single</em>-level or <em>double</em>-level subsetting). Note that <code>[[</code> can only take in a single scalar argument, rather than a vector of positions.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a>framingham_dataframe[<span class="dv">1</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>   totchol
1      195
2      250
3      245
4      285
5      205
6      313
7      254
8      247
9      291
10     195
11     195
12     190
13     215
14     294
15     247
16     295
17     226
18     175
19     180
20     243</code></pre>
</div>
</div>
<p>This returns a 1-column data frame.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a>framingham_dataframe[[<span class="dv">1</span>]]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> [1] 195 250 245 285 205 313 254 247 291 195 195 190 215 294 247 295 226 175 180
[20] 243</code></pre>
</div>
</div>
<p>This returns an atomic vector of length 20 with the contents of the first column.</p>
<p>Note that these functions also work when we supply the name of a column as a character string:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a>framingham_dataframe[, <span class="st">"totchol"</span>] <span class="co"># atomic vector</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> [1] 195 250 245 285 205 313 254 247 291 195 195 190 215 294 247 295 226 175 180
[20] 243</code></pre>
</div>
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a>framingham_dataframe[<span class="st">"totchol"</span>]   <span class="co"># 1-column data frame</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>   totchol
1      195
2      250
3      245
4      285
5      205
6      313
7      254
8      247
9      291
10     195
11     195
12     190
13     215
14     294
15     247
16     295
17     226
18     175
19     180
20     243</code></pre>
</div>
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a>framingham_dataframe[[<span class="st">"totchol"</span>]] <span class="co"># atomic vector</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> [1] 195 250 245 285 205 313 254 247 291 195 195 190 215 294 247 295 226 175 180
[20] 243</code></pre>
</div>
</div>
<p>Infuriatingly, the <code>[</code> function changes behaviour if you request two or more columns using <code>[row, c(col1, col2, ...)]</code> syntax:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a>framingham_dataframe[, <span class="fu">c</span>(<span class="st">"totchol"</span>, <span class="st">"death"</span>)] <span class="co"># now a data frame</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>   totchol death
1      195 FALSE
2      250 FALSE
3      245 FALSE
4      285 FALSE
5      205 FALSE
6      313 FALSE
7      254 FALSE
8      247 FALSE
9      291  TRUE
10     195 FALSE
11     195 FALSE
12     190 FALSE
13     215 FALSE
14     294  TRUE
15     247 FALSE
16     295 FALSE
17     226 FALSE
18     175 FALSE
19     180 FALSE
20     243 FALSE</code></pre>
</div>
</div>
<p>One of the main differences between <code>[</code> and <code>[[</code> is that the single-subset operator can take in multiple column names, while <code>[[</code> cannot. For example:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb26"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a>framingham_dataframe[[<span class="fu">c</span>(<span class="st">"totchol"</span>, <span class="st">"death"</span>)]]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-error">
<pre><code>Error in .subset2(x, i, exact = exact): subscript out of bounds</code></pre>
</div>
</div>
<p>Finally, we can use the <code>$</code> function to extract the contents of a <em>single column</em> by name <em>as a symbol</em> (not using quotes):</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb28"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a>framingham_dataframe<span class="sc">$</span>totchol</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> [1] 195 250 245 285 205 313 254 247 291 195 195 190 215 294 247 295 226 175 180
[20] 243</code></pre>
</div>
</div>
<p>This returns an atomic vector of length 20 with the contents of the first column.</p>
</section>
<section id="dplyr-1" class="level2">
<h2 class="anchored" data-anchor-id="dplyr-1">dplyr</h2>
<p>To select the first column of a tibble using dplyr subsetting rules, use <code>[</code> or the <code>select()</code> function. This uses column position only.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb30"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a>framingham_tbldf <span class="sc">%&gt;%</span> </span>
<span id="cb30-2"><a href="#cb30-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="dv">1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 20 × 1
   totchol
     &lt;int&gt;
 1     195
 2     250
 3     245
 4     285
 5     205
 6     313
 7     254
 8     247
 9     291
10     195
11     195
12     190
13     215
14     294
15     247
16     295
17     226
18     175
19     180
20     243</code></pre>
</div>
<div class="sourceCode cell-code" id="cb32"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a>framingham_tbldf[, <span class="dv">1</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 20 × 1
   totchol
     &lt;int&gt;
 1     195
 2     250
 3     245
 4     285
 5     205
 6     313
 7     254
 8     247
 9     291
10     195
11     195
12     190
13     215
14     294
15     247
16     295
17     226
18     175
19     180
20     243</code></pre>
</div>
<div class="sourceCode cell-code" id="cb34"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a>framingham_tbldf[<span class="dv">1</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 20 × 1
   totchol
     &lt;int&gt;
 1     195
 2     250
 3     245
 4     285
 5     205
 6     313
 7     254
 8     247
 9     291
10     195
11     195
12     190
13     215
14     294
15     247
16     295
17     226
18     175
19     180
20     243</code></pre>
</div>
</div>
<p>These all return the same 1-column tibble.</p>
<p>To access a column by name, we have two options: do we want the <em>contents</em> of the column or do we want the <em>column itself</em>.</p>
<section id="column-itself" class="level3">
<h3 class="anchored" data-anchor-id="column-itself">Column Itself</h3>
<p>We can use the <code>select()</code> function in addition to the <code>[</code> function to extract one or more columns. However, for the <code>select()</code> function, we are not required to supply the name in quotes, but rather we can use column names as a symbol object.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb36"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb36-1"><a href="#cb36-1" aria-hidden="true" tabindex="-1"></a>framingham_tbldf <span class="sc">%&gt;%</span> </span>
<span id="cb36-2"><a href="#cb36-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(totchol)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 20 × 1
   totchol
     &lt;int&gt;
 1     195
 2     250
 3     245
 4     285
 5     205
 6     313
 7     254
 8     247
 9     291
10     195
11     195
12     190
13     215
14     294
15     247
16     295
17     226
18     175
19     180
20     243</code></pre>
</div>
<div class="sourceCode cell-code" id="cb38"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb38-1"><a href="#cb38-1" aria-hidden="true" tabindex="-1"></a>framingham_tbldf[, <span class="st">"totchol"</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 20 × 1
   totchol
     &lt;int&gt;
 1     195
 2     250
 3     245
 4     285
 5     205
 6     313
 7     254
 8     247
 9     291
10     195
11     195
12     190
13     215
14     294
15     247
16     295
17     226
18     175
19     180
20     243</code></pre>
</div>
<div class="sourceCode cell-code" id="cb40"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb40-1"><a href="#cb40-1" aria-hidden="true" tabindex="-1"></a>framingham_tbldf[<span class="st">"totchol"</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 20 × 1
   totchol
     &lt;int&gt;
 1     195
 2     250
 3     245
 4     285
 5     205
 6     313
 7     254
 8     247
 9     291
10     195
11     195
12     190
13     215
14     294
15     247
16     295
17     226
18     175
19     180
20     243</code></pre>
</div>
</div>
<p>As with subsetting by position, these all return the same 1-column tibble. What’s more, is that—unlike a base R data frame—selecting more than one column does not change the behaviour of the function. Tibbles stay tibbles.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb42"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb42-1"><a href="#cb42-1" aria-hidden="true" tabindex="-1"></a>framingham_tbldf <span class="sc">%&gt;%</span> </span>
<span id="cb42-2"><a href="#cb42-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(totchol, death)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 20 × 2
   totchol death
     &lt;int&gt; &lt;lgl&gt;
 1     195 FALSE
 2     250 FALSE
 3     245 FALSE
 4     285 FALSE
 5     205 FALSE
 6     313 FALSE
 7     254 FALSE
 8     247 FALSE
 9     291 TRUE 
10     195 FALSE
11     195 FALSE
12     190 FALSE
13     215 FALSE
14     294 TRUE 
15     247 FALSE
16     295 FALSE
17     226 FALSE
18     175 FALSE
19     180 FALSE
20     243 FALSE</code></pre>
</div>
<div class="sourceCode cell-code" id="cb44"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb44-1"><a href="#cb44-1" aria-hidden="true" tabindex="-1"></a>framingham_tbldf[, <span class="fu">c</span>(<span class="st">"totchol"</span>, <span class="st">"death"</span>)]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 20 × 2
   totchol death
     &lt;int&gt; &lt;lgl&gt;
 1     195 FALSE
 2     250 FALSE
 3     245 FALSE
 4     285 FALSE
 5     205 FALSE
 6     313 FALSE
 7     254 FALSE
 8     247 FALSE
 9     291 TRUE 
10     195 FALSE
11     195 FALSE
12     190 FALSE
13     215 FALSE
14     294 TRUE 
15     247 FALSE
16     295 FALSE
17     226 FALSE
18     175 FALSE
19     180 FALSE
20     243 FALSE</code></pre>
</div>
<div class="sourceCode cell-code" id="cb46"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb46-1"><a href="#cb46-1" aria-hidden="true" tabindex="-1"></a>framingham_tbldf[<span class="fu">c</span>(<span class="st">"totchol"</span>, <span class="st">"death"</span>)]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 20 × 2
   totchol death
     &lt;int&gt; &lt;lgl&gt;
 1     195 FALSE
 2     250 FALSE
 3     245 FALSE
 4     285 FALSE
 5     205 FALSE
 6     313 FALSE
 7     254 FALSE
 8     247 FALSE
 9     291 TRUE 
10     195 FALSE
11     195 FALSE
12     190 FALSE
13     215 FALSE
14     294 TRUE 
15     247 FALSE
16     295 FALSE
17     226 FALSE
18     175 FALSE
19     180 FALSE
20     243 FALSE</code></pre>
</div>
</div>
</section>
<section id="column-contents" class="level3">
<h3 class="anchored" data-anchor-id="column-contents">Column Contents</h3>
<p>The <code>pull()</code> function works similarly to the <code>$</code> and <code>[[</code> functions: it takes in the name of a <em>single</em> column as a <em>symbol</em> object or a character string, and it returns the contents of the column as a vector.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb48"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb48-1"><a href="#cb48-1" aria-hidden="true" tabindex="-1"></a>framingham_tbldf <span class="sc">%&gt;%</span> </span>
<span id="cb48-2"><a href="#cb48-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pull</span>(totchol)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> [1] 195 250 245 285 205 313 254 247 291 195 195 190 215 294 247 295 226 175 180
[20] 243</code></pre>
</div>
<div class="sourceCode cell-code" id="cb50"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb50-1"><a href="#cb50-1" aria-hidden="true" tabindex="-1"></a>framingham_tbldf <span class="sc">%&gt;%</span> </span>
<span id="cb50-2"><a href="#cb50-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pull</span>(<span class="st">"totchol"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> [1] 195 250 245 285 205 313 254 247 291 195 195 190 215 294 247 295 226 175 180
[20] 243</code></pre>
</div>
<div class="sourceCode cell-code" id="cb52"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb52-1"><a href="#cb52-1" aria-hidden="true" tabindex="-1"></a>framingham_tbldf<span class="sc">$</span>totchol</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> [1] 195 250 245 285 205 313 254 247 291 195 195 190 215 294 247 295 226 175 180
[20] 243</code></pre>
</div>
<div class="sourceCode cell-code" id="cb54"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb54-1"><a href="#cb54-1" aria-hidden="true" tabindex="-1"></a>framingham_tbldf[[<span class="dv">1</span>]]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> [1] 195 250 245 285 205 313 254 247 291 195 195 190 215 294 247 295 226 175 180
[20] 243</code></pre>
</div>
<div class="sourceCode cell-code" id="cb56"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb56-1"><a href="#cb56-1" aria-hidden="true" tabindex="-1"></a>framingham_tbldf[[<span class="st">"totchol"</span>]]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> [1] 195 250 245 285 205 313 254 247 291 195 195 190 215 294 247 295 226 175 180
[20] 243</code></pre>
</div>
</div>
<p>These all return the same atomic vector of length 20 with the contents of the first column.</p>
<p><br></p>
<hr>
<p><br></p>
</section>
</section>
</section>
<section id="relational-subsetting" class="level1">
<h1>Relational Subsetting</h1>
<p>Finally, we can subset the rows of a data set by the relationships between the values a column and a specified value or by the relationships between one column and another. <strong>For the remainder of this lesson, we will use the “tibble” versions of the data only.</strong></p>
<section id="example-1-framingham-young-women" class="level2">
<h2 class="anchored" data-anchor-id="example-1-framingham-young-women">Example 1: Framingham Young Women</h2>
<p>For example, we want to find all the females in the Framingham data set younger than the 75th percentile for the ages of these recorded females. (Remember that this lesson uses a subset of the Framingham data, not the full data set. Your results will look different.)</p>
<section id="using-base" class="level3">
<h3 class="anchored" data-anchor-id="using-base">Using base</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb58"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb58-1"><a href="#cb58-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Subset the women</span></span>
<span id="cb58-2"><a href="#cb58-2" aria-hidden="true" tabindex="-1"></a>framinghamWomen_tbldf <span class="ot">&lt;-</span> </span>
<span id="cb58-3"><a href="#cb58-3" aria-hidden="true" tabindex="-1"></a>  framingham_tbldf[framingham_tbldf<span class="sc">$</span>sex <span class="sc">==</span> <span class="st">"Female"</span>, ]</span>
<span id="cb58-4"><a href="#cb58-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb58-5"><a href="#cb58-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Find the age threshold for P75</span></span>
<span id="cb58-6"><a href="#cb58-6" aria-hidden="true" tabindex="-1"></a>womenP75_num <span class="ot">&lt;-</span> <span class="fu">quantile</span>(framinghamWomen_tbldf<span class="sc">$</span>age, <span class="fl">0.75</span>)</span>
<span id="cb58-7"><a href="#cb58-7" aria-hidden="true" tabindex="-1"></a>framinghamWomenYoung_tbldf <span class="ot">&lt;-</span> </span>
<span id="cb58-8"><a href="#cb58-8" aria-hidden="true" tabindex="-1"></a>  framinghamWomen_tbldf[framinghamWomen_tbldf<span class="sc">$</span>age <span class="sc">&lt;</span> womenP75_num, ]</span>
<span id="cb58-9"><a href="#cb58-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb58-10"><a href="#cb58-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Remove intermediary pieces from memory</span></span>
<span id="cb58-11"><a href="#cb58-11" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span>(framinghamWomen_tbldf, womenP75_num)</span>
<span id="cb58-12"><a href="#cb58-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb58-13"><a href="#cb58-13" aria-hidden="true" tabindex="-1"></a><span class="co"># Inspect</span></span>
<span id="cb58-14"><a href="#cb58-14" aria-hidden="true" tabindex="-1"></a>framinghamWomenYoung_tbldf</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 9 × 12
  totchol   age   bmi  BPVar heartrte glucose time_outcome cigpday sex   
    &lt;int&gt; &lt;int&gt; &lt;dbl&gt;  &lt;dbl&gt;    &lt;int&gt;   &lt;int&gt;        &lt;dbl&gt;   &lt;int&gt; &lt;chr&gt; 
1     250    46  28.7   1.5        95      76        24          0 Female
2     285    46  23.1   9          85      85        11.7       23 Female
3     313    45  21.7 -19          79      78        23.8       20 Female
4     254    50  22.9   2.5        75      76        24          0 Female
5     247    43  27.6  13.5        72      61        24          0 Female
6     291    46  23.4  -6          80      89         3.95      20 Female
7     195    38  23.2   5.5        75      78         5.91       5 Female
8     190    42  21.6 -15.5        72      85        16.2       30 Female
9     243    43  26.9  -1.75       68      78        24         10 Female
# ℹ 3 more variables: curSmoke &lt;lgl&gt;, highBP &lt;lgl&gt;, death &lt;lgl&gt;</code></pre>
</div>
</div>
</section>
<section id="using-dplyr" class="level3">
<h3 class="anchored" data-anchor-id="using-dplyr">Using dplyr</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb60"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb60-1"><a href="#cb60-1" aria-hidden="true" tabindex="-1"></a>framingham_tbldf <span class="sc">%&gt;%</span></span>
<span id="cb60-2"><a href="#cb60-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(sex <span class="sc">==</span> <span class="st">"Female"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb60-3"><a href="#cb60-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(age <span class="sc">&lt;</span> <span class="fu">quantile</span>(age, <span class="fl">0.75</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 9 × 12
  totchol   age   bmi  BPVar heartrte glucose time_outcome cigpday sex   
    &lt;int&gt; &lt;int&gt; &lt;dbl&gt;  &lt;dbl&gt;    &lt;int&gt;   &lt;int&gt;        &lt;dbl&gt;   &lt;int&gt; &lt;chr&gt; 
1     250    46  28.7   1.5        95      76        24          0 Female
2     285    46  23.1   9          85      85        11.7       23 Female
3     313    45  21.7 -19          79      78        23.8       20 Female
4     254    50  22.9   2.5        75      76        24          0 Female
5     247    43  27.6  13.5        72      61        24          0 Female
6     291    46  23.4  -6          80      89         3.95      20 Female
7     195    38  23.2   5.5        75      78         5.91       5 Female
8     190    42  21.6 -15.5        72      85        16.2       30 Female
9     243    43  26.9  -1.75       68      78        24         10 Female
# ℹ 3 more variables: curSmoke &lt;lgl&gt;, highBP &lt;lgl&gt;, death &lt;lgl&gt;</code></pre>
</div>
</div>
</section>
</section>
<section id="example-2-countries-with-highest-infant-mortality" class="level2">
<h2 class="anchored" data-anchor-id="example-2-countries-with-highest-infant-mortality">Example 2: Countries with Highest Infant Mortality</h2>
<p>As another example, we want to find the 25 countries in the Gapminder data set which had the largest infant mortality rate in 2010.</p>
<section id="using-base-1" class="level3">
<h3 class="anchored" data-anchor-id="using-base-1">Using base</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb62"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb62-1"><a href="#cb62-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Save a subset of the Gapminder data only for the year 2010</span></span>
<span id="cb62-2"><a href="#cb62-2" aria-hidden="true" tabindex="-1"></a>gapminder2010_tbldf <span class="ot">&lt;-</span> </span>
<span id="cb62-3"><a href="#cb62-3" aria-hidden="true" tabindex="-1"></a>  gapminder_tbldf[gapminder_tbldf[[<span class="st">"year"</span>]] <span class="sc">==</span> <span class="dv">2010</span>, ]</span>
<span id="cb62-4"><a href="#cb62-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-5"><a href="#cb62-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Find the order of the rows by worst infant mortality to best</span></span>
<span id="cb62-6"><a href="#cb62-6" aria-hidden="true" tabindex="-1"></a>worstInfMort_idx <span class="ot">&lt;-</span> <span class="fu">order</span>(</span>
<span id="cb62-7"><a href="#cb62-7" aria-hidden="true" tabindex="-1"></a>  gapminder2010_tbldf[[<span class="st">"infant_mortality"</span>]],</span>
<span id="cb62-8"><a href="#cb62-8" aria-hidden="true" tabindex="-1"></a>  <span class="at">decreasing =</span> <span class="cn">TRUE</span></span>
<span id="cb62-9"><a href="#cb62-9" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb62-10"><a href="#cb62-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-11"><a href="#cb62-11" aria-hidden="true" tabindex="-1"></a><span class="co"># Subset the 2010 data by the first 25 indices in the "worst" vector</span></span>
<span id="cb62-12"><a href="#cb62-12" aria-hidden="true" tabindex="-1"></a>gapminderInfMort2010_tbldf <span class="ot">&lt;-</span></span>
<span id="cb62-13"><a href="#cb62-13" aria-hidden="true" tabindex="-1"></a>  gapminder2010_tbldf[worstInfMort_idx[<span class="dv">1</span><span class="sc">:</span><span class="dv">25</span>], ]</span>
<span id="cb62-14"><a href="#cb62-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-15"><a href="#cb62-15" aria-hidden="true" tabindex="-1"></a><span class="co"># Inspect</span></span>
<span id="cb62-16"><a href="#cb62-16" aria-hidden="true" tabindex="-1"></a>gapminderInfMort2010_tbldf</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 25 × 10
   country    year infant_mortality life_expectancy fertility population     gdp
   &lt;fct&gt;     &lt;int&gt;            &lt;dbl&gt;           &lt;dbl&gt;     &lt;dbl&gt;      &lt;dbl&gt;   &lt;dbl&gt;
 1 Angola     2010            110.             57.6      6.22   21219954 2.61e10
 2 Sierra L…  2010            107              55        4.94    5775902 1.57e 9
 3 Central …  2010            102.             47.9      4.63    4444973 1.05e 9
 4 Chad       2010             93.6            55.8      6.6    11896380 3.37e 9
 5 Haiti      2010             85.5            32.2      3.35    9999617 3.70e 9
 6 Congo, D…  2010             84.8            58.4      6.25   65938712 6.96e 9
 7 Mali       2010             82.9            59.2      6.84   15167286 4.20e 9
 8 Nigeria    2010             81.5            61.2      6.02  159424742 8.56e10
 9 Equatori…  2010             78.9            58.6      5.14     728710 5.98e 9
10 Cote d'I…  2010             76.9            56.6      4.91   20131707 1.16e10
# ℹ 15 more rows
# ℹ 3 more variables: continent &lt;fct&gt;, region &lt;fct&gt;, gdpPerCap &lt;dbl&gt;</code></pre>
</div>
</div>
</section>
<section id="using-dplyr-1" class="level3">
<h3 class="anchored" data-anchor-id="using-dplyr-1">Using dplyr</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb64"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb64-1"><a href="#cb64-1" aria-hidden="true" tabindex="-1"></a>gapminder_tbldf <span class="sc">%&gt;%</span> </span>
<span id="cb64-2"><a href="#cb64-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(year <span class="sc">==</span> <span class="dv">2010</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb64-3"><a href="#cb64-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(<span class="fu">desc</span>(infant_mortality)) <span class="sc">%&gt;%</span> </span>
<span id="cb64-4"><a href="#cb64-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">slice</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">25</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 25 × 10
   country    year infant_mortality life_expectancy fertility population     gdp
   &lt;fct&gt;     &lt;int&gt;            &lt;dbl&gt;           &lt;dbl&gt;     &lt;dbl&gt;      &lt;dbl&gt;   &lt;dbl&gt;
 1 Angola     2010            110.             57.6      6.22   21219954 2.61e10
 2 Sierra L…  2010            107              55        4.94    5775902 1.57e 9
 3 Central …  2010            102.             47.9      4.63    4444973 1.05e 9
 4 Chad       2010             93.6            55.8      6.6    11896380 3.37e 9
 5 Haiti      2010             85.5            32.2      3.35    9999617 3.70e 9
 6 Congo, D…  2010             84.8            58.4      6.25   65938712 6.96e 9
 7 Mali       2010             82.9            59.2      6.84   15167286 4.20e 9
 8 Nigeria    2010             81.5            61.2      6.02  159424742 8.56e10
 9 Equatori…  2010             78.9            58.6      5.14     728710 5.98e 9
10 Cote d'I…  2010             76.9            56.6      4.91   20131707 1.16e10
# ℹ 15 more rows
# ℹ 3 more variables: continent &lt;fct&gt;, region &lt;fct&gt;, gdpPerCap &lt;dbl&gt;</code></pre>
</div>
</div>
<p><br></p>
<hr>
<p><br></p>
</section>
</section>
</section>
<section id="concluding-remarks" class="level1">
<h1>Concluding Remarks</h1>
<p>This lesson I usually only assign if we have quite a few students who had learned some version of R in the past. Many of my students “learned R” by copying and pasting their professor’s code, Googling the errors, and making changes until the problems went away. This isn’t learning. This is beating your code into submission. It’s not healthy for long-term research success.</p>
<p>If you learned this way, I apologize, but you will most likely have to “unlearn” what you learned first, then re-learn R as a modern computing language for data science and statistical learning. This lesson is to give you a comparison to some of the variants of data management in R that you may have learned in other classes. Hopefully, this helps you compare the two schools of thought. Some of you will still prefer your “old way” of doing things, and I suppose that I can’t fault you for wanting to stay in your comfort zone. It’s comfortable there, after all. But, you have a chance to learn some more sophisticated data management techniques, and I suggest you take it.</p>


</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp("https:\/\/d6d6e52e-2b0a-417a-ad51-33547ea826a7\.netlify\.app\/");
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      // TODO in 1.5, we should make sure this works without a callout special case
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
<nav class="page-navigation">
  <div class="nav-page nav-page-previous">
      <a href="../lessons/lesson09_dplyr.html" class="pagination-link" aria-label="Lesson 9: Data Manipulation with dplyr">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text">Lesson 9: Data Manipulation with dplyr</span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="../lessons/lesson10_stringr.html" class="pagination-link" aria-label="Lesson 10: Wrangling Character Strings with stringr">
        <span class="nav-page-text">Lesson 10: Wrangling Character Strings with stringr</span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav>
</div> <!-- /content -->




</body></html>